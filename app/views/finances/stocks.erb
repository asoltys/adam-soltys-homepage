<% title('Stocks') %>

<h3>Executions</h3>

<table id="portfolio">
	<tr>
		<th>Date</th>
		<th>Type</th>
		<th>Company</th>
		<th>Shares</th>
		<th>Price</th>
		<th>Commission</th>
		<th>Amount</th>
	</tr>
	<% for t in @account.executions.reverse %>
	<tr>
		<td><%= t.date %></td>
		<td><%= t.execution_type %></td>
		<td><%= link_to t.stock.company, "http://finance.google.com/finance?q=#{t.stock.symbol}" %></td>
		<td><%= t.shares %></td>
		<td>$<%= sprintf("%.2f", t.price) %></td>
		<td>$<%= gain_or_loss(-t.commission) %></td>
		<td>$<%= gain_or_loss(t.amount) %></td>
	</tr>
	<% end %>
	<tr>
		<td colspan="4"></td>
		<td><strong>Total:</strong></td>
		<td>$<%= gain_or_loss(-@account.commission) %></td>
		<td>$<%= gain_or_loss(@account.balance) %></td>
	</tr>
</table>

<h3>Current Positions</h3>

<table id="positions">
	<tr>
		<th>Company</th>
		<th>Shares</th>
		<th>Avg Purchase Price</th>
		<th>Current Price</th>
		<th>Market Value</th>
		<th>Gain/Loss</th>
		<th>Percent Return</th>
	</tr>
	<% for p in @account.positions %>
	<tr>
		<td><%= link_to p.stock.company, "http://finance.google.com/finance?q=#{p.stock.symbol}" %></td>
		<td><%= p.shares %></td>
		<td>$<%= sprintf("%.2f", p.price) %></td>
		<td>$<%= sprintf("%.2f", p.stock.price) %></td>
		<td>$<%= sprintf("%.2f", p.value) %></td>
		<td>$<%= gain_or_loss(p.gain) %></td>
		<td><%= gain_or_loss(p.percent_return) %>%</td>
	</tr>
	<% end %>
</table>

<h3>Totals</h3>

<table>
	<tr>
		<th>Current Market Value</th>
		<th>Account Balance</th>
		<th>Projected Profit</th>
		<th>Projected Percent Return</th>
	</tr>
	<tr>
		<td>$<%= sprintf("%.2f", @account.market_value) %></td>
		<td>$<%= gain_or_loss(@account.balance) %></td>
		<td>$<%= gain_or_loss(@account.profit) %></td>
		<td><%= gain_or_loss(@account.percent_return) %>%</td>
	</tr>
</table>
